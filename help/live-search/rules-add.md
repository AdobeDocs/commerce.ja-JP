---
title: ルールの追加
description: 検索マーチャンダイジングルールを作成する方法について説明します。
exl-id: 7175ccf7-d838-43b0-a176-957e7db040e0
source-git-commit: 449b281e46d16de56f4c3d2e01e7165c59ee78a2
workflow-type: tm+mt
source-wordcount: '1650'
ht-degree: 0%

---

# ルールの追加

ルールを作成するには、まずルールエディターを使用して、関連するイベントをトリガーにする買い物客のクエリテキストの条件を定義します。 次に、ルールの詳細を完了し、結果をテストして、ルールを公開します。

## ルールを追加

1. 管理者で、**マーケティング**/SEO と検索/**[!DNL Live Search]** に移動します。
1. **範囲** を設定して、ルールが適用される [ ストア表示 ](https://experienceleague.adobe.com/docs/commerce-admin/start/setup/websites-stores-views.html#scope-settings) を識別します。
1. **マーチャンダイジングを検索** ワークスペースをクリックします。
1. 「**ルールを追加**」をクリックして、ルールエディターを起動します。

## ルールタイプ

検索クエリでは、特定の検索語句、条件およびランキングタイプを定義します。

より具体的な検索クエリが定義されていない限り、すべてのクエリに適用されるデフォルトのルールを設定できます。 設定できるデフォルトルールは 1 つだけで、条件を含めることはできません。 「デフォルト」を選択した場合、「条件」インターフェイスは表示されません。
デフォルトのインテリジェントランキングタイプと、すべてのデフォルト検索に適用する手動ランキングを選択します。 手動によるランキングは常に適用されます。

## 条件

条件は、イベントをトリガーするための要件です。 1 つのルールには、最大 10 個の条件と 25 個のイベントを含めることができます。 既定のルールには条件を設定できません。

![ ルール – ルールを作成 ](assets/rules-add-workspace.png)

>[!NOTE]
>
>現在、特定の顧客グループに対してルールをターゲットにすることはできません。

### 単一条件

1. *ルールを作成* の下で、満たす **条件** を選択し、指示に従って文を完成させます。

   * 検索クエリに次を含める – 買い物客のクエリに含める必要があるテキストの文字列を入力します。 「一致」設定では、買い物客のクエリがカタログと一致する度合いを決定します。 オプション：<br /> すべて – 買い物客のクエリテキストのどの部分も条件に一致する可能性があります。<br /> すべて – 買い物客のすべてのクエリが条件に一致する必要があります。
   * 検索クエリは – 買い物客のクエリと完全に一致するテキスト文字列を入力します。 例：「ヨガパンツ」。 `Search query is` と Match `All` を持つルールには、条件を 1 つだけ指定できます。
   * 検索クエリの先頭の文字 – 買い物客のクエリの先頭にする必要がある文字またはテキスト文字列を入力します。
   * 検索クエリが次で終わる – 買い物客のクエリの最後にする必要がある文字またはテキスト文字列を入力します。

   結果は、「*ルールをテスト*」ペインにすぐに表示され、優先度別に番号が付けられます。 上部の「*1 行あたりの結果* スライダーを使用できます    各行の製品数を変更する権限。

   ![ ルール – 単純 ](assets/rule-simple-test.png)

1. 他のクエリをテストするには、「*ルールをテスト*」検索ボックスのクエリテキストを変更し、**Return** キーを押します。
最初、テストペインでは条件検索ボックスからクエリがレンダリングされます。 ただし、現在は、テストクエリボックスからクエリをレンダリングしています。 テストペインでは、一度に 1 つのクエリのみがレンダリングされます。
1. 結果が気に入ったら、「*条件*」検索ボックスのテキストを更新します。 次に、ページ上の任意の場所をクリックして、テストペインの結果を更新します。
1. 1 つの条件で単純なルールを作成するには、手順 3:[ イベントの追加 ](#events) に進みます。

### 複数の条件

1. 複数の条件を持つルールを作成するには、「**条件を追加**」をクリックします。
ルールには、最大 10 個の条件を指定できます。 2 つの条件を結合する論理演算子は、現在の *一致* 設定に基づいています。 デフォルトでは、*Match* は `All` で、論理演算子は `AND` です。

1. 2 番目の条件を選択し、必要なクエリテキストを入力します。

1. ルールのロジックを変更するには、「**一致**」設定を変更して、買い物客の検索条件がクエリ条件にどの程度一致する必要があるかを決定します。 **一致** を次のいずれかに設定します。

   * 任意 – （デフォルト）ルール内のすべての論理演算子は `OR` に設定され、結果がテストペインに表示されます。
   * すべて – ルール内のすべての論理演算子が `AND` に設定され、結果がテストペインに表示されます。

   *Match* 値は、複数の条件の結合に使用される論理演算子を決定します。 *一致* 設定を変更すると、ルール内のすべての論理演算子が変更されます。 `AND` と `OR` を同じルールに組み合わせることはできません。

   この例では、「yoga pants」ではなく、「yoga」または「pants」を検索する 2 つの異なるクエリがあります。 このルールは特異性が低く、他のルールよりもストアフロントでトリガーされる頻度が高くなります。

   ![ ルール – 一致 ](assets/rules-match.png)

1. 別の条件を追加するには、「**条件を追加**」をクリックしてプロセスを繰り返します。

## インテリジェントランキング

インテリジェントランキングは、ユーザーの行動とサイト統計を組み合わせて、製品ランキングを決定します。
ストアの所有者は、次のタイプのランキング戦略を設定できます。

![ ルール – 一致 ](assets/rules-ranking-type.png)

* 最も多く購入された：これにより、過去 7 日間の SKU あたりの合計購入数で製品がランク付けされます。
* 買い物かごに最も追加された – 過去 7 日間の合計「買い物かごに追加」アクティビティの順にランク付けされます。
* 最も多く閲覧された：過去 7 日間の SKU ごとの合計閲覧回数をランク付けします。
* あなたにお勧め – この SKU を表示した買い物客も、`viewed-viewed` の他の SKU を見ています。
* トレンド：過去 72 時間のページビューイベントをバックグラウンドイベントで、24 時間のフォアグラウンドイベントで振り返ります。
* なし：製品は関連度で並べ替えられます。

ルールの戦略のタイプを選択します。 **ルールをテスト** ウィンドウに、期待される結果が表示されます。

### 注意事項

* クエリでのアポストロフィと引用符は、一部の言語で、ランキングと関連性に関するいくつかの小さな問題を引き起こす可能性があります。
* インテリジェントランキングが正しく機能するように、検索またはフィルタリング **ファセット）に使用する製品属性の** 検索の重み付け）が `5` 以下であることを確認します。 この設定を [!DNL Commerce] Admin で見つけるには：

   1. **Stores**/_Attributes_/**Product** を選択します。
   1. 「name」などの属性を検索します。
   1. **属性情報**/**ストアフロントのプロパティ** ページで、検索の重み付けを `5` 以下に設定します。

      ![Product - Search Weight](assets/set-search-weight.png)

## 手動ランキング

手動ランキング（以前のイベント）は、定義された条件が満たされた場合に検索結果を変更するアクションです。 1 つのルールには、最大 25 個のイベントを含めることができます。

* ブースト – 検索結果で製品を上に移動します。
* Bury – 検索結果で SKU を下に移動します。
* 製品をピン留め – 製品は、ページ上の選択した「位置」に表示されます。
* 製品を非表示 – 検索結果から SKU を除外します。

製品をピン留めする最も簡単な方法は、ドラッグ&amp;ドロップです。

1. テストペインで製品をクリックしてドラッグします。 目的の位置にドラッグ&amp;ドロップします。 「製品」および「位置」フィールドは、イベント ペインに自動的に入力されます。

   ![ ルール – 一致 ](assets/rule-event-pin-product.png)

ピン アイコンをクリックして、製品を現在の場所にピン留めすることもできます。 省略記号コンテキストメニューを使用して、「上にピン留め」または「下にピン留め」を使用します。

>[!NOTE]
>
>ピン留めできるのは、クエリで返された製品のみです。

または、イベントは手動で設定できます。

1. *イベント* で、関連する条件が満たされた場合に実行される **イベント** を選択します。

   例えば、「`Hide a product`」を選択します。 次に、非表示にする製品の名前を入力します。 製品は入力時に推奨されます。

1. 複数のイベントの場合、条件が満たされた場合にトリガーにしたい他のイベントを選択します。

## 追加の詳細

ここで入力した情報は、[ ルールの詳細 ](rules-workspace.md) パネルに表示されます。

1. *詳細* で、ルールの **名前** を入力します。 すべてのルール名は一意である必要があります。
1. ルールの簡単な **説明** を入力します。
1. ルールを有効にする **開始日** と **終了日** を入力するか、カレンダーから日付を選択します。

   日付範囲を選択するには、最初の日付をクリックし、ドラッグして範囲を選択します。

   ![ ルール – 完了 ](assets/rule-add-details.png)

## ルールの最終処理

1. テストペインでルールの結果を調べます。
1. ルールに複数のクエリがある場合は、ルールの影響を受ける可能性のあるクエリをそれぞれテストします。
1. 完了したら、「**保存して公開**」をクリックします。

   ルールが *ルール* ワークスペースのリストに追加されます。

1. アクティブなルールはすぐに有効になりますが、ストアフロントでキャッシュされたクエリ結果が更新されるまで、最大 15 分待つ必要がある場合があります。

>[!NOTE]
>
>デフォルトの並べ替え順「並べ替え基準：最も関連性の高い」が選択されている場合、ルールと手動でランク付けされた製品が検索結果に適用されます。 買い物客が並べ替え順を「名前で並べ替え」や「価格で並べ替え」などに変更すると、ルールと手動のランキングは無効になります。

## フィールドの説明

### 条件（if）

| 条件 | 説明 |
|--- |--- |
| 検索クエリに次を含む | 買い物客のクエリに含まれる文字またはテキスト文字列。 この条件を満たすには、買い物客のクエリが 1 文字のみに一致する必要があります。 |
| 検索クエリは | 買い物客のクエリと完全に一致する文字またはテキスト文字列。 この条件を使用する場合、複数の条件を持つ複雑なクエリを構成することはできません。 |
| 検索クエリが次の語句で始まる | 買い物客のクエリは、この文字またはテキスト文字列で始まります。 |
| 検索クエリが次で終わる | 買い物客のクエリが、この文字またはテキスト文字列で終わる。 |

### 論理演算子

| 演算子 | 説明 |
|--- |--- |
| または | （デフォルト）論理演算子 `OR` は、2 つの条件を比較し、少なくとも 1 つの条件が true の場合にイベントをトリガーするための要件を満たしています。 |
| および | 論理演算子 `AND` は、2 つの条件を比較し、両方の条件が true の場合にイベントをトリガー化するための要件を満たします。 |

### 演算子に一致

| 演算子 | 説明 |
|--- |--- |
| 任意 | ルール内のすべての論理演算子を `OR` に変更し、一致する製品セットを返します。 |
| すべて | ルール内のすべての論理演算子を `AND` に変更し、一致する製品セットを返します。 |

### 手動ランキング

| イベント | 説明 |
|--- |--- |
| ブースト | 検索結果で SKU または SKU の範囲を上に移動します。 各には、テスト検索結果で「ブースト済み」プレビューバッジが付きます。 |
| 埋める | 検索結果で SKU または SKU の範囲を下に移動します。 各には、テスト検索結果の「埋め込み」プレビューバッジが付きます。 |
| 製品をピン留め | 検索結果の特定の位置に 1 つの SKU を添付します。 製品は、テスト検索結果に「ピン留め」プレビューバッジでマークされます。 |
| 製品を非表示 | 検索結果から SKU または SKU の範囲を除外します。 |

### 詳細

| フィールド | 説明 |
|--- |--- |
| 名前 | ルールの名前。 ルール名は一意である必要があります。 |
| ルールタイプ | デフォルトまたはクエリ。 より具体的なクエリルールが定義されていない限り、デフォルトはすべてのルールに適用されます。 |
| 開始日 | ルールの開始日（予定されている場合）。 |
| 終了日 | ルールの終了日（予定されている場合）。 |
| 説明 | ルールの簡単な説明。 |
